<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>wyrm.io &mdash; Wyrm 0.8.beta documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.8.beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="top" title="Wyrm 0.8.beta documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Wyrm 0.8.beta documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for wyrm.io</h1><div class="highlight"><pre>
<span class="c"># encoding: utf8</span>

<span class="sd">&quot;&quot;&quot;Various input/output methods.</span>

<span class="sd">This module provides methods for loading and saving data from- and into</span>
<span class="sd">various formats.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="kn">from</span> <span class="nn">wyrm.types</span> <span class="kn">import</span> <span class="n">Data</span>


<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="save"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.save">[docs]</a><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a ``Data`` object into a NumPy .npy file.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Data</span>
<span class="sd">        `Data` object</span>
<span class="sd">    filename : str</span>
<span class="sd">        Filename of the file to save to. If the filename does not end</span>
<span class="sd">        with ``.npy``, the ``.npy`` extension will be automatically</span>
<span class="sd">        appended.</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :func:`load`</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; io.save(dat, &#39;foo.npy&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dat2 = io.load(&#39;foo.npy&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="load"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.load">[docs]</a><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a ``Data`` object from a file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        the file to load the data from</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat : Data</span>
<span class="sd">        the data loaded from the file</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :func:`save`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; io.save(dat, &#39;foo.npy&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dat2 = io.load(&#39;foo.npy&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c"># this is truly disgusting, apparently np.load returns a numpy array</span>
    <span class="c"># that contains the pickled ``Data`` object but the array has no</span>
    <span class="c"># elements, shape or whatever. The workaround is to flatten it and</span>
    <span class="c"># return the first (i.e. only) element...</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dat</span>

</div>
<div class="viewcode-block" id="load_brain_vision_data"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.load_brain_vision_data">[docs]</a><span class="k">def</span> <span class="nf">load_brain_vision_data</span><span class="p">(</span><span class="n">vhdr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load Brain Vision data from a file.</span>

<span class="sd">    This methods loads the continuous EEG data, and returns a ``Data``</span>
<span class="sd">    object of continuous data ``[time, channel]``, along with the</span>
<span class="sd">    markers and the sampling frequency. The EEG data is returned in</span>
<span class="sd">    micro Volt.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vhdr : str</span>
<span class="sd">        Path to a VHDR file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat : Data</span>
<span class="sd">        Continuous Data with the additional attributes ``.fs`` for the</span>
<span class="sd">        sampling frequency and ``.marker`` for a list of markers. Each</span>
<span class="sd">        marker is a tuple of ``(time in ms, marker)``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    AssertionError</span>
<span class="sd">        If one of the consistency checks fails</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; dat = load_brain_vision_data(&#39;path/to/vhdr&#39;)</span>
<span class="sd">    &gt;&gt;&gt; dat.fs</span>
<span class="sd">    1000</span>
<span class="sd">    &gt;&gt;&gt; dat.data.shape</span>
<span class="sd">    (54628, 61)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Loading Brain Vision Data Exchange Header File&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vhdr</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">fdata</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
    <span class="n">fdata</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;;&#39;</span><span class="p">),</span> <span class="n">fdata</span><span class="p">)</span>
    <span class="n">fdata</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
    <span class="c"># check for the correct file version:</span>
    <span class="k">assert</span> <span class="n">fdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;1.0&#39;</span><span class="p">)</span>
    <span class="c"># read all data into a dict where the key is the stanza of the file</span>
    <span class="n">file_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fdata</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;[&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;]&#39;</span><span class="p">):</span>
            <span class="n">current_stanza</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">file_dict</span><span class="p">[</span><span class="n">current_stanza</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_dict</span><span class="p">[</span><span class="n">current_stanza</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="c"># translate known stanzas from simple list of strings to a dict</span>
    <span class="k">for</span> <span class="n">stanza</span> <span class="ow">in</span> <span class="s">&#39;Common Infos&#39;</span><span class="p">,</span> <span class="s">&#39;Binary Infos&#39;</span><span class="p">,</span> <span class="s">&#39;Channel Infos&#39;</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">stanza</span><span class="p">)</span>
        <span class="n">file_dict</span><span class="p">[</span><span class="n">stanza</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file_dict</span><span class="p">[</span><span class="n">stanza</span><span class="p">]}</span>
    <span class="c"># now file_dict contains the parsed data from the vhdr file</span>
    <span class="c"># load the rest</span>
    <span class="n">data_f</span> <span class="o">=</span> <span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;DataFile&#39;</span><span class="p">]</span>
    <span class="n">marker_f</span> <span class="o">=</span> <span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;MarkerFile&#39;</span><span class="p">]</span>
    <span class="n">data_f</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">vhdr</span><span class="p">),</span> <span class="n">data_f</span><span class="p">])</span>
    <span class="n">marker_f</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">vhdr</span><span class="p">),</span> <span class="n">marker_f</span><span class="p">])</span>
    <span class="n">n_channels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;NumberOfChannels&#39;</span><span class="p">])</span>
    <span class="n">sampling_interval_microseconds</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;SamplingInterval&#39;</span><span class="p">])</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">sampling_interval_microseconds</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Channel Infos&#39;</span><span class="p">][</span><span class="s">&#39;Ch</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">)]</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">channels</span><span class="p">)</span>
    <span class="n">resolutions</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Channel Infos&#39;</span><span class="p">][</span><span class="s">&#39;Ch</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">)]</span>
    <span class="n">resolutions</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">resolutions</span><span class="p">)</span>
    <span class="c"># assert all channels have the same resolution of 0.1</span>
    <span class="c"># FIXME: that is not always true, for example if we measure pulse or</span>
    <span class="c"># emg</span>
    <span class="c">#assert all([i == 0.1 for i in resolutions])</span>
    <span class="c"># some assumptions about the data...</span>
    <span class="k">assert</span> <span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;DataFormat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;BINARY&#39;</span>
    <span class="k">assert</span> <span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Common Infos&#39;</span><span class="p">][</span><span class="s">&#39;DataOrientation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;MULTIPLEXED&#39;</span>
    <span class="k">assert</span> <span class="n">file_dict</span><span class="p">[</span><span class="s">&#39;Binary Infos&#39;</span><span class="p">][</span><span class="s">&#39;BinaryFormat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;INT_16&#39;</span>
    <span class="c"># load EEG data</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Loading EEG Data.&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">data_f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">*=</span> <span class="n">resolutions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># duration in ms</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">n_samples</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="c"># load marker</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Loading Marker.&#39;</span><span class="p">)</span>
    <span class="n">regexp</span> <span class="o">=</span> <span class="s">r&#39;^Mk(?P&lt;mrk_nr&gt;[0-9]*)=.*,(?P&lt;mrk_descr&gt;.*),(?P&lt;mrk_pos&gt;[0-9]*),[0-9]*,[0-9]*$&#39;</span>
    <span class="n">mrk</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">marker_f</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regexp</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">mrk_pos</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;mrk_pos&#39;</span><span class="p">)</span>
            <span class="n">mrk_descr</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;mrk_descr&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mrk_descr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c"># marker := [samplenr, marker]</span>
                <span class="c">#mrk.append([int(mrk_pos), mrk_descr])</span>
                <span class="c"># marker := [time in ms, marker]</span>
                <span class="n">mrk</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">time</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mrk_pos</span><span class="p">)],</span> <span class="n">mrk_descr</span><span class="p">])</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="n">time</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;channel&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;ms&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">])</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">mrk</span>
    <span class="k">return</span> <span class="n">dat</span>

</div>
<div class="viewcode-block" id="load_mushu_data"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.load_mushu_data">[docs]</a><span class="k">def</span> <span class="nf">load_mushu_data</span><span class="p">(</span><span class="n">meta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load saved EEG data in Mushu&#39;s format.</span>

<span class="sd">    This method loads saved data in Mushu&#39;s format and returns a</span>
<span class="sd">    continuous ``Data`` object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    meta : str</span>
<span class="sd">        Path to `.meta` file. A Mushu recording consists of three</span>
<span class="sd">        different files: `.eeg`, `.marker`, and `.meta`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat : Data</span>
<span class="sd">        Continuous Data object</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; dat = load_mushu_data(&#39;testrecording.meta&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># reverse and replace and reverse again to replace only the last</span>
    <span class="c"># (occurrence of .meta)</span>
    <span class="n">datafile</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;atem.&#39;</span><span class="p">,</span> <span class="s">&#39;gee.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">markerfile</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;atem.&#39;</span><span class="p">,</span> <span class="s">&#39;rekram.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span> <span class="ow">and</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">markerfile</span><span class="p">)</span>
    <span class="c"># load meta data</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s">&#39;Sampling Frequency&#39;</span><span class="p">]</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s">&#39;Channels&#39;</span><span class="p">])</span>
    <span class="c"># load eeg data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">datafile</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)))</span>
    <span class="c"># load markers</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">markerfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">ts</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">markers</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()])</span>
    <span class="c"># construct Data</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">fs</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="n">channels</span><span class="p">]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;channels&#39;</span><span class="p">]</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;ms&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">]</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span>
    <span class="k">return</span> <span class="n">dat</span>

</div>
<div class="viewcode-block" id="convert_mushu_data"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.convert_mushu_data">[docs]</a><span class="k">def</span> <span class="nf">convert_mushu_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">markers</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert mushu data into wyrm&#39;s ``Data`` format.</span>

<span class="sd">    This convenience method creates a continuous ``Data`` object from</span>
<span class="sd">    the parameters given. The timeaxis always starts from zero and its</span>
<span class="sd">    values are calculated from the sampling frequency ``fs`` and the</span>
<span class="sd">    length of ``data``. The ``names`` and ``units`` attributes are</span>
<span class="sd">    filled with default vaules.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : 2d array</span>
<span class="sd">        an 2 dimensional numpy array with the axes: (time, channel)</span>
<span class="sd">    markers : list of tuples: (float, str)</span>
<span class="sd">        a list of markers. Each element is a tuple of timestamp and</span>
<span class="sd">        string. The timestamp is the time in ms relative to the onset of</span>
<span class="sd">        the block of data. Note that negative values are *allowed* as</span>
<span class="sd">        well as values bigger than the length of the block of data</span>
<span class="sd">        returned. That is to be interpreted as a marker from the last</span>
<span class="sd">        block and a marker for a future block respectively.</span>
<span class="sd">    fs : float</span>
<span class="sd">        the sampling frequency, this number is used to calculate the</span>
<span class="sd">        timeaxis for the data</span>
<span class="sd">    channels : list or 1d array of strings</span>
<span class="sd">        the channel names</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cnt : continuous ``Data`` object</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Assuming that ``amp`` is an Amplifier instance from ``libmushu``,</span>
<span class="sd">    already configured but not started yet:</span>

<span class="sd">    &gt;&gt;&gt; amp_fs = amp.get_sampling_frequency()</span>
<span class="sd">    &gt;&gt;&gt; amp_channels = amp.get_channels()</span>
<span class="sd">    &gt;&gt;&gt; amp.start()</span>
<span class="sd">    &gt;&gt;&gt; while True:</span>
<span class="sd">    ...     data, markers = amp.get_data()</span>
<span class="sd">    ...     cnt = convert_mushu_data(data, markers, amp_fs, amp_channels)</span>
<span class="sd">    ...     # some more code</span>
<span class="sd">    &gt;&gt;&gt; amp.stop()</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    https://github.com/venthur/mushu</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">fs</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">chan_axis</span> <span class="o">=</span> <span class="n">channels</span><span class="p">[:]</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_axis</span><span class="p">,</span> <span class="n">chan_axis</span><span class="p">]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;channel&#39;</span><span class="p">]</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;uV&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">]</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
    <span class="n">cnt</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[:]</span>
    <span class="n">cnt</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
    <span class="k">return</span> <span class="n">cnt</span>

</div>
<div class="viewcode-block" id="load_bcicomp3_ds1"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.load_bcicomp3_ds1">[docs]</a><span class="k">def</span> <span class="nf">load_bcicomp3_ds1</span><span class="p">(</span><span class="n">dirname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load the BCI Competition III Data Set 1.</span>

<span class="sd">    This method loads the data set and converts it into Wyrm&#39;s ``Data``</span>
<span class="sd">    format. Before you use it, you have to download the training- and</span>
<span class="sd">    test data in Matlab format and unpack it into a directory.</span>

<span class="sd">    .. note::</span>

<span class="sd">        If you need the true labels of the test sets, you&#39;ll have to</span>
<span class="sd">        download them separately from</span>
<span class="sd">        http://bbci.de/competition/iii/results/index.html#labels</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dirname : str</span>
<span class="sd">        the directory where the ``Competition_train.mat`` and</span>
<span class="sd">        ``Competition_test.mat`` are located</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    epo_train, epo_test : epoched ``Data`` objects</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; epo_test, epo_train = load_bcicomp3_ds1(&#39;/home/foo/bcicomp3_dataset1/&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># construct the filenames from the dirname</span>
    <span class="n">training_file</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">dirname</span><span class="p">,</span> <span class="s">&#39;Competition_train.mat&#39;</span><span class="p">])</span>
    <span class="n">test_file</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">dirname</span><span class="p">,</span> <span class="s">&#39;Competition_test.mat&#39;</span><span class="p">])</span>

    <span class="c"># load the training data</span>
    <span class="n">training_data_mat</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="n">training_file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">training_data_mat</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;double&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">training_data_mat</span><span class="p">[</span><span class="s">&#39;Y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;int&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="c"># convert into wyrm Data</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Class&#39;</span><span class="p">,</span> <span class="s">&#39;Time&#39;</span><span class="p">,</span> <span class="s">&#39;Channel&#39;</span><span class="p">]</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;#&#39;</span><span class="p">,</span> <span class="s">&#39;ms&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">]</span>
    <span class="n">dat_train</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
    <span class="n">dat_train</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">dat_train</span><span class="o">.</span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;pinky&#39;</span><span class="p">,</span> <span class="s">&#39;tongue&#39;</span><span class="p">]</span>

    <span class="c"># load the test data</span>
    <span class="n">test_data_mat</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">test_data_mat</span><span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;double&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="c"># convert into wyrm Data</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Epoch&#39;</span><span class="p">,</span> <span class="s">&#39;Time&#39;</span><span class="p">,</span> <span class="s">&#39;Channel&#39;</span><span class="p">]</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;#&#39;</span><span class="p">,</span> <span class="s">&#39;ms&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">]</span>
    <span class="n">dat_test</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">names</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">)</span>
    <span class="n">dat_test</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c"># map labels -1 -&gt; 0</span>
    <span class="n">dat_test</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">dat_test</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dat_train</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">dat_train</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">dat_train</span><span class="p">,</span> <span class="n">dat_test</span>

</div>
<div class="viewcode-block" id="load_bcicomp3_ds2"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.load_bcicomp3_ds2">[docs]</a><span class="k">def</span> <span class="nf">load_bcicomp3_ds2</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load the BCI Competition III Data Set 2.</span>

<span class="sd">    This method loads the data set and converts it into Wyrm&#39;s ``Data``</span>
<span class="sd">    format. Before you use it, you have to download the data set in</span>
<span class="sd">    Matlab format and unpack it. The directory with the extracted files</span>
<span class="sd">    must contain the ``Subject_*.mat``- and the ``eloc64.txt`` files.</span>

<span class="sd">    .. note::</span>

<span class="sd">        If you need the true labels of the test sets, you&#39;ll have to</span>
<span class="sd">        download them separately from</span>
<span class="sd">        http://bbci.de/competition/iii/results/index.html#labels</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The path to the matlab file to load</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cnt : continuous `Data` object</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; dat = load_bcicomp3_ds2(&#39;/home/foo/data/Subject_A_Train.mat&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">STIMULUS_CODE</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c"># cols from left to right</span>
        <span class="mi">1</span> <span class="p">:</span> <span class="s">&quot;agmsy5&quot;</span><span class="p">,</span>
        <span class="mi">2</span> <span class="p">:</span> <span class="s">&quot;bhntz6&quot;</span><span class="p">,</span>
        <span class="mi">3</span> <span class="p">:</span> <span class="s">&quot;ciou17&quot;</span><span class="p">,</span>
        <span class="mi">4</span> <span class="p">:</span> <span class="s">&quot;djpv28&quot;</span><span class="p">,</span>
        <span class="mi">5</span> <span class="p">:</span> <span class="s">&quot;ekqw39&quot;</span><span class="p">,</span>
        <span class="mi">6</span> <span class="p">:</span> <span class="s">&quot;flrx4_&quot;</span><span class="p">,</span>
        <span class="c"># rows from top to bottom</span>
        <span class="mi">7</span> <span class="p">:</span> <span class="s">&quot;abcdef&quot;</span><span class="p">,</span>
        <span class="mi">8</span> <span class="p">:</span> <span class="s">&quot;ghijkl&quot;</span><span class="p">,</span>
        <span class="mi">9</span> <span class="p">:</span> <span class="s">&quot;mnopqr&quot;</span><span class="p">,</span>
        <span class="mi">10</span><span class="p">:</span> <span class="s">&quot;stuvwx&quot;</span><span class="p">,</span>
        <span class="mi">11</span><span class="p">:</span> <span class="s">&quot;yz1234&quot;</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">:</span> <span class="s">&quot;56789_&quot;</span>
        <span class="p">}</span>

    <span class="c"># load the matlab data</span>
    <span class="n">data_mat</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c"># load the channel names (the same for all datasets</span>
    <span class="n">eloc_file</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s">&#39;eloc64.txt&#39;</span><span class="p">])</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">eloc_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
    <span class="c"># fix the channel names, some letters have the wrong capitalization</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">channels</span><span class="p">):</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;Z&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;FP&#39;</span><span class="p">,</span> <span class="s">&#39;Fp&#39;</span><span class="p">)</span>
        <span class="n">channels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>
    <span class="c"># The signal is recorded with 64 channels, bandpass filtered</span>
    <span class="c"># 0.1-60Hz and digitized at 240Hz. The format is Character Epoch x</span>
    <span class="c"># Samples x Channels</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data_mat</span><span class="p">[</span><span class="s">&#39;Signal&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;double&#39;</span><span class="p">)</span>
    <span class="c"># For each sample: 1 if a row/colum was flashed, 0 otherwise</span>
    <span class="n">flashing</span> <span class="o">=</span> <span class="n">data_mat</span><span class="p">[</span><span class="s">&#39;Flashing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c">#flashing = np.flatnonzero((np.diff(a) == 1)) + 1</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flashing</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flashing</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">flashing</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">flashing</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flashing</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">flashing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="c"># For each sample: 0 when no row/colum was intensified,</span>
    <span class="c"># 1..6 for intensified columns, 7..12 for intensified rows</span>
    <span class="n">stimulus_code</span> <span class="o">=</span> <span class="n">data_mat</span><span class="p">[</span><span class="s">&#39;StimulusCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">stimulus_code</span> <span class="o">=</span> <span class="n">stimulus_code</span><span class="p">[</span><span class="n">flashing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c"># 0 if no row/col was intensified or the intensified did not contain</span>
    <span class="c"># the target character, 1 otherwise</span>
    <span class="n">stimulus_type</span> <span class="o">=</span> <span class="n">data_mat</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;StimulusType&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c"># The target characters</span>
    <span class="n">target_chars</span> <span class="o">=</span> <span class="n">data_mat</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;TargetChar&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="mi">240</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">timeaxis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">fs</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">dat</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="n">timeaxis</span><span class="p">,</span> <span class="n">channels</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;channel&#39;</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;ms&#39;</span><span class="p">,</span> <span class="s">&#39;#&#39;</span><span class="p">])</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span>
    <span class="c"># preparing the markers</span>
    <span class="n">target_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">((</span><span class="n">flashing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">stimulus_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stimulus_type</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">nontarget_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">((</span><span class="n">flashing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">stimulus_type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stimulus_type</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">flashing</span> <span class="o">=</span> <span class="p">(</span><span class="n">flashing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">flashing</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;flashing&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">timeaxis</span><span class="p">[</span><span class="n">flashing</span><span class="p">]]</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;target&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">timeaxis</span><span class="p">[</span><span class="n">target_mask</span><span class="p">]]</span>
    <span class="n">nontargets</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;nontarget&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">timeaxis</span><span class="p">[</span><span class="n">nontarget_mask</span><span class="p">]]</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">stimulus_code</span> <span class="o">=</span> <span class="n">stimulus_code</span><span class="p">[:]</span>
    <span class="n">stimulus_code</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">([</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">flashing</span><span class="p">],</span> <span class="p">[</span><span class="n">STIMULUS_CODE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">stimulus_code</span><span class="p">])</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="n">flashing</span><span class="p">[:]</span>
    <span class="n">markers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
    <span class="n">markers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nontargets</span><span class="p">)</span>
    <span class="n">markers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">stimulus_code</span><span class="p">)</span>
    <span class="n">markers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">dat</span><span class="o">.</span><span class="n">markers</span> <span class="o">=</span> <span class="n">markers</span><span class="p">[:]</span>
    <span class="k">return</span> <span class="n">dat</span>

</div>
<div class="viewcode-block" id="PyffComm"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm">[docs]</a><span class="k">class</span> <span class="nc">PyffComm</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pyff communication object.</span>

<span class="sd">    This class allows for communication with a running Pyff [1]_</span>
<span class="sd">    instance. It uses the json protocol, so you have to start Pyff with</span>
<span class="sd">    the ``--protocol=json`` parameter.</span>

<span class="sd">    Receiving data from Pyff (i.e. the available feedbacks and</span>
<span class="sd">    variables) is not supported for now.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    This is an example session, demonstrating how to load a feedback</span>
<span class="sd">    application, set a variable, start it, quit it and closing Pyff in</span>
<span class="sd">    the end.</span>

<span class="sd">    &gt;&gt;&gt; pyff = PyffComm()</span>
<span class="sd">    &gt;&gt;&gt; pyff.send_init(&#39;TrivialPong&#39;)</span>
<span class="sd">    &gt;&gt;&gt; pyff.set_variables({&#39;FPS&#39;: 30})</span>
<span class="sd">    &gt;&gt;&gt; pyff.play()</span>
<span class="sd">    &gt;&gt;&gt; pyff.quit()</span>
<span class="sd">    &gt;&gt;&gt; pyff.quit_pyff()</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] Bastian Venthur, Simon Scholler, John Williamson, Sven Dähne,</span>
<span class="sd">        Matthias S Treder, Maria T Kramarek, Klaus-Robert Müller and</span>
<span class="sd">        Benjamin Blankertz. Pyff---A Pythonic Framework for Feedback</span>
<span class="sd">        Applications and Stimulus Presentation in Neuroscience.</span>
<span class="sd">        Frontiers in Neuroscience. 2010. doi: 10.3389/fnins.2010.00179.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">12345</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the Pyff Communicator object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        host : str, optional</span>
<span class="sd">            hostname or IP of the machine running Pyff</span>
<span class="sd">        port : int, optional</span>
<span class="sd">            port on which Pyff is listening on.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>

<div class="viewcode-block" id="PyffComm.send_interaction_signal"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.send_interaction_signal">[docs]</a>    <span class="k">def</span> <span class="nf">send_interaction_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send interaction signal to Pyff.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            This method is used internally to send low level JSON</span>
<span class="sd">            messages to Pyff. You should not use this method directly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cmd : str</span>
<span class="sd">        data : dict</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;interaction-signal&#39;</span><span class="p">,</span>
                <span class="s">&#39;data&#39;</span> <span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                <span class="s">&#39;commands&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="n">cmd</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()]]}</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PyffComm.send_control_signal"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.send_control_signal">[docs]</a>    <span class="k">def</span> <span class="nf">send_control_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a control signal to the running feedback.</span>

<span class="sd">        This method is used to send events to the feedback like a new</span>
<span class="sd">        classifier output.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables : dict</span>
<span class="sd">            the keys are the variable names and the values the values.</span>
<span class="sd">            Those variables sent by the control signal are not set</span>
<span class="sd">            directly in the feedback. If you want this behave use</span>
<span class="sd">            :func:`set_variables`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;type&#39;</span> <span class="p">:</span> <span class="s">&#39;control-signal&#39;</span><span class="p">,</span>
                <span class="s">&#39;data&#39;</span> <span class="p">:</span> <span class="n">variables</span><span class="p">,</span>
                <span class="s">&#39;commands&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">}</span>
        <span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">json_str</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="PyffComm.send_init"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.send_init">[docs]</a>    <span class="k">def</span> <span class="nf">send_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a Feedback.</span>

<span class="sd">        This method sends Pyff the ``send_init(feedback)`` command which</span>
<span class="sd">        loads a feedback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fb : string</span>
<span class="sd">            The name of the feedback.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;sendinit&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;_feedback&#39;</span><span class="p">:</span> <span class="n">fb</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="PyffComm.play"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.play">[docs]</a>    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the feedback.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;play&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyffComm.pause"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.pause">[docs]</a>    <span class="k">def</span> <span class="nf">pause</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pause the feedback.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;pause&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyffComm.stop"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the feedback.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;stop&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyffComm.quit"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.quit">[docs]</a>    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quit the feedback.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;quit&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyffComm.quit_pyff"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.quit_pyff">[docs]</a>    <span class="k">def</span> <span class="nf">quit_pyff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quit Pyff.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="s">&#39;quitfeedbackcontroller&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PyffComm.set_variables"><a class="viewcode-back" href="../../api/wyrm.html#wyrm.io.PyffComm.set_variables">[docs]</a>    <span class="k">def</span> <span class="nf">set_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set internal variables in the feedback.</span>

<span class="sd">        Use this method to create or modify instance variables of the</span>
<span class="sd">        currently running feedback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables : dict</span>
<span class="sd">            The variable names are the keys, the values are the values</span>
<span class="sd">            of the variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_interaction_signal</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">variables</span><span class="p">)</span>
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Wyrm 0.8.beta documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Bastian Venthur.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>